(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AddArt"],{"0898":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("a-card",[r("h3",[t._v(t._s(t.id?"编辑文章":"新增文章"))]),r("a-form-model",{ref:"artInfoRef",attrs:{model:t.artInfo,rules:t.artInfoRules,hideRequiredMark:!0}},[r("a-row",{attrs:{gutter:24}},[r("a-col",{attrs:{span:16}},[r("a-form-model-item",{attrs:{label:"文章标题",prop:"title"}},[r("a-input",{staticStyle:{width:"300px"},model:{value:t.artInfo.title,callback:function(e){t.$set(t.artInfo,"title",e)},expression:"artInfo.title"}})],1),r("a-form-model-item",{attrs:{label:"文章描述",prop:"desc"}},[r("a-input",{attrs:{type:"textarea"},model:{value:t.artInfo.desc,callback:function(e){t.$set(t.artInfo,"desc",e)},expression:"artInfo.desc"}})],1),r("a-form-model-item",{attrs:{label:"文章标签"}},[r("div",[t._l(t.taglist,(function(e){return[r("a-checkable-tag",{key:e.id,attrs:{checked:t.selectedTags.indexOf(e.id)>-1},on:{change:function(r){return t.handleChange(e.id,r)}}},[t._v(" "+t._s(e.name)+" ")])]}))],2)])],1),r("a-col",{attrs:{span:8}},[r("a-form-model-item",{attrs:{label:"文章分类",prop:"cid"}},[r("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择分类"},on:{change:t.cateChange},model:{value:t.artInfo.cid,callback:function(e){t.$set(t.artInfo,"cid",e)},expression:"artInfo.cid"}},t._l(t.Catelist,(function(e){return r("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),r("a-form-model-item",{attrs:{label:"文章缩略图",prop:"img"}},[r("a-upload",{attrs:{listType:"picture",name:"file",action:t.upUrl,headers:t.headers},on:{change:t.upChange}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),t._v("点击上传 ")],1),t.id?[r("img",{staticStyle:{width:"120px",height:"100px","margin-left":"15px"},attrs:{src:t.artInfo.img}})]:t._e()],2)],1)],1)],1),r("a-form-model-item",{attrs:{label:"文章内容",prop:"content"}},[r("mavon-editor",{ref:"md",staticStyle:{height:"calc(100vh - 200px)"},on:{imgAdd:t.mdUploadImg},model:{value:t.artInfo.content,callback:function(e){t.$set(t.artInfo,"content",e)},expression:"artInfo.content"}})],1),r("a-form-model-item",[r("a-button",{staticStyle:{"margin-right":"15px"},attrs:{type:"danger"},on:{click:function(e){return t.artOk(t.artInfo.id)}}},[t._v(" "+t._s(t.artInfo.id?"更新":"提交")+" ")]),r("a-button",{attrs:{type:"primary"},on:{click:t.addCancel}},[t._v("取消")])],1)],1)],1)],1)},n=[],s=(r("99af"),r("4de4"),r("2909")),i=(r("96cf"),r("1da1")),o=r("5bf0"),c={props:["id"],data:function(){return{artInfo:{id:0,title:"",cid:void 0,desc:"",content:"",img:""},Catelist:[],taglist:[],selectedTags:[],upUrl:o["a"]+"upload",headers:{},fileList:[],artInfoRules:{title:[{required:!0,message:"请输入文章标题",trigger:"change"}],cid:[{required:!0,message:"请选择文章分类",trigger:"change"}],desc:[{required:!0,message:"请输入文章描述",trigger:"change"},{max:120,message:"描述最多可写120个字符",trigger:"change"}],img:[{required:!0,message:"请选择文章缩略图",trigger:"change"}],content:[{required:!0,message:"请输入文章内容",trigger:"change"}]}}},mounted:function(){this.getCateList(),this.getTagList(),this.headers={Authorization:"Bearer ".concat(window.sessionStorage.getItem("token"))},this.id&&(this.getArtInfo(this.id),this.getArtTags(this.id))},methods:{getTagList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("admin/tags");case 2:r=e.sent,a=r.data,200!==a.status&&(1004!==a.status&&1005!==a.status&&1006!==a.status&&1007!==a.status||(window.sessionStorage.clear(),t.$router.push("/login")),t.$message.error(a.message)),t.taglist=a.data;case 6:case"end":return e.stop()}}),e)})))()},getArtTags:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.$http.get("articleTag/art/".concat(t));case 2:if(a=r.sent,n=a.data,200===n.status){r.next=6;break}return r.abrupt("return",e.$message.error("获取指定文章的标签失败!"));case 6:if(0!==n.total)for(s=0;s<n.total;s++)e.selectedTags.push(n.data[s].id);case 7:case"end":return r.stop()}}),r)})))()},handleChange:function(t,e){var r=this.selectedTags,a=e?[].concat(Object(s["a"])(r),[t]):r.filter((function(e){return e!==t}));console.log("You are interested in: ",a),this.selectedTags=a},getArtInfo:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.$http.get("admin/article/info/".concat(t));case 2:a=r.sent,n=a.data,200!==n.status&&(1004!==n.status&&1005!==n.status&&1006!==n.status&&1007!==n.status||(window.sessionStorage.clear(),e.$router.push("/login")),e.$message.error(n.message)),e.artInfo=n.data,e.artInfo.id=n.data.ID;case 7:case"end":return r.stop()}}),r)})))()},getCateList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("admin/category");case 2:r=e.sent,a=r.data,200!==a.status&&(1004!==a.status&&1005!==a.status&&1006!==a.status&&1007!==a.status||(window.sessionStorage.clear(),t.$router.push("/login")),t.$message.error(a.message)),t.Catelist=a.data;case 6:case"end":return e.stop()}}),e)})))()},cateChange:function(t){this.artInfo.cid=t},upChange:function(t){t.file.status,"done"===t.file.status?(this.$message.success("图片上传成功"),this.artInfo.img=t.file.response.url):"error"===t.file.status&&this.$message.error("图片上传失败")},mdUploadImg:function(t,e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,s,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=new FormData,n.append("file",e),s={Authorization:"Bearer ".concat(window.sessionStorage.getItem("token"))},s["Content-Type"]="multipart/form-data",a.next=6,r.$http({url:"/upload",method:"post",data:n,headers:s});case 6:i=a.sent,o=i.data,200!==o.status&&r.$message.error("上传图片失败"),r.$message.success("上传图片成功"),r.$refs.md.$img2Url(t,o.url);case 11:case"end":return a.stop()}}),a)})))()},artOk:function(t){var e=this;this.$refs.artInfoRef.validate(function(){var r=Object(i["a"])(regeneratorRuntime.mark((function r(a){var n,s,i,o,c,u,d,l,f,g;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a){r.next=2;break}return r.abrupt("return",e.$message.error("参数验证未通过，请按要求录入文章内容"));case 2:if(0!=e.selectedTags.length){r.next=4;break}return r.abrupt("return",e.$message.error("请选择文章标签"));case 4:if(0!==t){r.next=21;break}return r.next=7,e.$http.post("article/add",e.artInfo);case 7:if(n=r.sent,s=n.data,200===s.status){r.next=11;break}return r.abrupt("return",e.$message.error(s.message));case 11:return r.next=13,e.$http.post("articleTag/".concat(s.data.ID),e.selectedTags);case 13:if(i=r.sent,o=i.data,200===o.status){r.next=17;break}return r.abrupt("return",e.$message.error("为当前ID文章绑定标签失败!"));case 17:e.$router.push("/artlist"),e.$message.success("添加文章成功"),r.next=41;break;case 21:return r.next=23,e.$http.put("article/".concat(t),e.artInfo);case 23:if(c=r.sent,u=c.data,200===u.status){r.next=27;break}return r.abrupt("return",e.$message.error(u.message));case 27:return r.next=29,e.$http.delete("articleTag/art/".concat(t));case 29:if(d=r.sent,l=d.data,200===l.status){r.next=33;break}return r.abrupt("return",e.$message.error("为当前ID文章删除标签失败"));case 33:return r.next=35,e.$http.post("articleTag/".concat(t),e.selectedTags);case 35:if(f=r.sent,g=f.data,200===g.status){r.next=39;break}return r.abrupt("return",e.$message.error("为当前ID文章绑定标签失败!"));case 39:e.$router.push("/artlist"),e.$message.success("更新文章成功");case 41:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())},addCancel:function(){this.$refs.artInfoRef.resetFields()}}},u=c,d=r("2877"),l=Object(d["a"])(u,a,n,!1,null,null,null);e["default"]=l.exports},"25f0":function(t,e,r){"use strict";var a=r("6eeb"),n=r("825a"),s=r("d039"),i=r("ad6d"),o="toString",c=RegExp.prototype,u=c[o],d=s((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),l=u.name!=o;(d||l)&&a(RegExp.prototype,o,(function(){var t=n(this),e=String(t.source),r=t.flags,a=String(void 0===r&&t instanceof RegExp&&!("flags"in c)?i.call(t):r);return"/"+e+"/"+a}),{unsafe:!0})},2909:function(t,e,r){"use strict";function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=new Array(e);r<e;r++)a[r]=t[r];return a}function n(t){if(Array.isArray(t))return a(t)}r.d(e,"a",(function(){return c}));r("a4d3"),r("e01a"),r("d28b"),r("a630e"),r("d3b7"),r("3ca3"),r("ddb0");function s(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}r("fb6a"),r("b0c0"),r("25f0");function i(t,e){if(t){if("string"===typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return n(t)||s(t)||i(t)||o()}},"3ca3":function(t,e,r){"use strict";var a=r("6547").charAt,n=r("69f3"),s=r("7dd0"),i="String Iterator",o=n.set,c=n.getterFor(i);s(String,"String",(function(t){o(this,{type:i,string:String(t),index:0})}),(function(){var t,e=c(this),r=e.string,n=e.index;return n>=r.length?{value:void 0,done:!0}:(t=a(r,n),e.index+=t.length,{value:t,done:!1})}))},"4df4":function(t,e,r){"use strict";var a=r("0366"),n=r("7b0b"),s=r("9bdd"),i=r("e95a"),o=r("50c4"),c=r("8418"),u=r("35a1");t.exports=function(t){var e,r,d,l,f,g,p=n(t),h="function"==typeof this?this:Array,m=arguments.length,v=m>1?arguments[1]:void 0,b=void 0!==v,y=u(p),x=0;if(b&&(v=a(v,m>2?arguments[2]:void 0,2)),void 0==y||h==Array&&i(y))for(e=o(p.length),r=new h(e);e>x;x++)g=b?v(p[x],x):p[x],c(r,x,g);else for(l=y.call(p),f=l.next,r=new h;!(d=f.call(l)).done;x++)g=b?s(l,v,[d.value,x],!0):d.value,c(r,x,g);return r.length=x,r}},6547:function(t,e,r){var a=r("a691"),n=r("1d80"),s=function(t){return function(e,r){var s,i,o=String(n(e)),c=a(r),u=o.length;return c<0||c>=u?t?"":void 0:(s=o.charCodeAt(c),s<55296||s>56319||c+1===u||(i=o.charCodeAt(c+1))<56320||i>57343?t?o.charAt(c):s:t?o.slice(c,c+2):i-56320+(s-55296<<10)+65536)}};t.exports={codeAt:s(!1),charAt:s(!0)}},"99af":function(t,e,r){"use strict";var a=r("23e7"),n=r("d039"),s=r("e8b5"),i=r("861d"),o=r("7b0b"),c=r("50c4"),u=r("8418"),d=r("65f0"),l=r("1dde"),f=r("b622"),g=r("2d00"),p=f("isConcatSpreadable"),h=9007199254740991,m="Maximum allowed index exceeded",v=g>=51||!n((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),b=l("concat"),y=function(t){if(!i(t))return!1;var e=t[p];return void 0!==e?!!e:s(t)},x=!v||!b;a({target:"Array",proto:!0,forced:x},{concat:function(t){var e,r,a,n,s,i=o(this),l=d(i,0),f=0;for(e=-1,a=arguments.length;e<a;e++)if(s=-1===e?i:arguments[e],y(s)){if(n=c(s.length),f+n>h)throw TypeError(m);for(r=0;r<n;r++,f++)r in s&&u(l,f,s[r])}else{if(f>=h)throw TypeError(m);u(l,f++,s)}return l.length=f,l}})},"9bdd":function(t,e,r){var a=r("825a"),n=r("2a62");t.exports=function(t,e,r,s){try{return s?e(a(r)[0],r[1]):e(r)}catch(i){throw n(t),i}}},a630e:function(t,e,r){var a=r("23e7"),n=r("4df4"),s=r("1c7e"),i=!s((function(t){Array.from(t)}));a({target:"Array",stat:!0,forced:i},{from:n})},ad6d:function(t,e,r){"use strict";var a=r("825a");t.exports=function(){var t=a(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},b0c0:function(t,e,r){var a=r("83ab"),n=r("9bf2").f,s=Function.prototype,i=s.toString,o=/^\s*function ([^ (]*)/,c="name";a&&!(c in s)&&n(s,c,{configurable:!0,get:function(){try{return i.call(this).match(o)[1]}catch(t){return""}}})},d28b:function(t,e,r){var a=r("746f");a("iterator")},ddb0:function(t,e,r){var a=r("da84"),n=r("fdbc"),s=r("e260"),i=r("9112"),o=r("b622"),c=o("iterator"),u=o("toStringTag"),d=s.values;for(var l in n){var f=a[l],g=f&&f.prototype;if(g){if(g[c]!==d)try{i(g,c,d)}catch(h){g[c]=d}if(g[u]||i(g,u,l),n[l])for(var p in s)if(g[p]!==s[p])try{i(g,p,s[p])}catch(h){g[p]=s[p]}}}},e01a:function(t,e,r){"use strict";var a=r("23e7"),n=r("83ab"),s=r("da84"),i=r("5135"),o=r("861d"),c=r("9bf2").f,u=r("e893"),d=s.Symbol;if(n&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var l={},f=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof f?new d(t):void 0===t?d():d(t);return""===t&&(l[e]=!0),e};u(f,d);var g=f.prototype=d.prototype;g.constructor=f;var p=g.toString,h="Symbol(test)"==String(d("test")),m=/^Symbol\((.*)\)[^)]+$/;c(g,"description",{configurable:!0,get:function(){var t=o(this)?this.valueOf():this,e=p.call(t);if(i(l,t))return"";var r=h?e.slice(7,-1):e.replace(m,"$1");return""===r?void 0:r}}),a({global:!0,forced:!0},{Symbol:f})}},fb6a:function(t,e,r){"use strict";var a=r("23e7"),n=r("861d"),s=r("e8b5"),i=r("23cb"),o=r("50c4"),c=r("fc6a"),u=r("8418"),d=r("b622"),l=r("1dde"),f=r("ae40"),g=l("slice"),p=f("slice",{ACCESSORS:!0,0:0,1:2}),h=d("species"),m=[].slice,v=Math.max;a({target:"Array",proto:!0,forced:!g||!p},{slice:function(t,e){var r,a,d,l=c(this),f=o(l.length),g=i(t,f),p=i(void 0===e?f:e,f);if(s(l)&&(r=l.constructor,"function"!=typeof r||r!==Array&&!s(r.prototype)?n(r)&&(r=r[h],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return m.call(l,g,p);for(a=new(void 0===r?Array:r)(v(p-g,0)),d=0;g<p;g++,d++)g in l&&u(a,d,l[g]);return a.length=d,a}})}}]);
//# sourceMappingURL=AddArt.ce6db8f5.js.map